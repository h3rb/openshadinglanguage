# SPI-specific settings

ifeq ($(SP_ARCH), spinux1_x86_64)
platform=spinux1
# put any gcc-4.4/spinux1 specific stuff here
MY_CMAKE_FLAGS += \
		  -DILMBASE_CUSTOM=1 \
		  -DILMBASE_CUSTOM_LIBRARIES="SpiImath SpiHalf SpiIlmThread SpiIex" \
		  -DOPENEXR_CUSTOM=1 \
		  -DOPENEXR_CUSTOM_LIBRARY="SpiIlmImf" \
                  -DLLVM_CUSTOM=1 \
		  -DLLVM_VERSION=2.7 \
		  -DLLVM_DIRECTORY=/shots/spi/home/lib/arnold/spinux1/llvm_2.7

ifeq (${OSL_NAMESPACE},)
OSL_NAMESPACE='OSL_Arnold'
endif
ifeq (${OPENIMAGEIO_NAMESPACE},)
OPENIMAGEIO_NAMESPACE='OpenImageIO_Arnold'
endif

endif # SP_ARCH == spinux1_x86_64

ifeq ($(SP_ARCH), rhel40_x86_64)
platform=rhel40m64
OPENEXR_VERSION=1.4.0
BOOST_VERSION=1_34_1

MY_CMAKE_FLAGS += \
		-DxCMAKE_CXX_COMPILER=/opt/gcc421/bin/g++ \
		-DxCMAKE_C_COMPILER=/opt/gcc421/bin/gcc \
		-DFLEX_EXECUTABLE=/net/soft_scratch/apps/arnold/tools/rhel40m64/bin/flex \
		-DSPECIAL_COMPILE_FLAGS="-include ${working_dir}/site/spi/include/spi_ns.h" \
		-DBOOST_CUSTOM=1 \
		-DBoost_INCLUDE_DIRS=/usr/local64/include/boost-${BOOST_VERSION} \
		-DBoost_LIBRARY_DIRS=/usr/local64/lib/boost-${BOOST_VERSION} \
		-DBoost_LIBRARIES="-lboost_filesystem-gcc34-mt-${BOOST_VERSION} -lboost_regex-gcc34-mt-${BOOST_VERSION} -lboost_thread-gcc34-mt-${BOOST_VERSION} " \
		-DILMBASE_HOME=/usr/local64/openexr/${OPENEXR_VERSION} \
		-DOPENEXR_VERSION=${OPENEXR_VERSION} \
		-DOPENEXR_VERSION_DIGITS="010400" \
		-DOPENEXR_HOME=/usr/local64/openexr/${OPENEXR_VERSION} \
		-DUSE_LLVM=0
ifeq (${OSL_NAMESPACE},)
OSL_NAMESPACE='OSL_Arnold'
endif
ifeq (${OPENIMAGEIO_NAMESPACE},)
OPENIMAGEIO_NAMESPACE='OpenImageIO_Arnold'
endif

endif # SP_ARCH == rhel40_x86_64


# if this is a debug build then use OIIO's debug build
ifeq (${DEBUG},1)
OIIO_VARIANT='.debug'
else
OIIO_VARIANT=''
endif

# set up OpenImageIO distribution environment
ifeq (${OPENIMAGEIOHOME},)
MY_CMAKE_FLAGS += -DOPENIMAGEIOHOME:STRING=${working_dir}/../OpenImageIO_local/dist/${platform}${OIIO_VARIANT}/ \
                  -DOSL_NAMESPACE:STRING=${OSL_NAMESPACE} \
                  -DOPENIMAGEIO_NAMESPACE:STRING=${OPENIMAGEIO_NAMESPACE}
else
MY_CMAKE_FLAGS += -DOPENIMAGEIOHOME:STRING=${IMAGEIOHOME} \
		  -DOSL_NAMESPACE:STRING=${OSL_NAMESPACE} \
		  -DOPENIMAGEIO_NAMESPACE:STRING=${OPENIMAGEIO_NAMESPACE}
endif

$(info MY_CMAKE_FLAGS: $(MY_CMAKE_FLAGS))

